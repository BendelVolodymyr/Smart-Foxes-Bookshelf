{"version":3,"file":"commonHelpers2.js","sources":["../src/js/reg_form.js"],"sourcesContent":["const elements = {\n  registrationForm: document.getElementById(\"registration_form\"),\n  loginForm: document.getElementById(\"login_form\"),\n  registrationName: document.getElementById(\"registration_name\"),\n  registrationEmail: document.getElementById(\"registration_email\"),\n  registrationPassword: document.getElementById(\"registration_password\"),\n  closeModalButton: document.getElementById(\"closeModalButton\"),\n  showRegistrationFormButton: document.getElementById(\"showRegistrationFormButton\"),\n  showLoginFormButton: document.getElementById(\"showLoginFormButton\"),\n  registerButton: document.getElementById(\"registerButton\"),\n  loginButton: document.getElementById(\"loginButton\"),\n  loginEmail: document.getElementById(\"login_email\"), // Added this line\n  loginPassword: document.getElementById(\"login_password\"), // Added this line\n  userDropdown: document.querySelector(\".select-menu\"),\n  signUpButton: document.querySelector(\".header-link-log-up\"),\n  mobileActiveAcc: document.querySelector(\".mobile-active-acc\"),\n  userInfoContainer: document.getElementById(\"user_info\"),\n  userNameElement: document.querySelector(\".user-name\"),\n  googleSignInButton: document.getElementById(\"googleSignInButton\"),\n  logoutButton: document.getElementById(\"logoutButton\"),\n};\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAQpcHlYnmJgrkoX3KbdR3qCIHswCf3vaM\",\n  authDomain: \"bookshelf-smartfoxes-team.firebaseapp.com\",\n  projectId: \"bookshelf-smartfoxes-team\",\n  storageBucket: \"bookshelf-smartfoxes-team.appspot.com\",\n  messagingSenderId: \"615845871184\",\n  appId: \"1:615845871184:web:f8e6e3da332e48b2721b55\",\n  measurementId: \"G-J4EFJFQ0WD\"\n};\nfirebase.initializeApp(firebaseConfig);\nconst auth = firebase.auth();\nconst database = firebase.database();\n\nfunction saveUserDataToLocalStorage(userData) {\n  localStorage.setItem(\"user_data\", JSON.stringify(userData));\n}\n\nfunction getUserDataFromLocalStorage() {\n  const userDataString = localStorage.getItem(\"user_data\");\n  return userDataString ? JSON.parse(userDataString) : null;\n}\n\nfunction closeModal() {\n  elements.registrationForm.style.display = 'none';\n  window.location.href = \"./index.html\";\n}\n\nfunction showRegistrationForm() {\n  elements.registrationForm.style.display = \"flex\";\n  elements.loginForm.style.display = \"none\";\n}\n\nfunction showLoginForm() {\n  elements.registrationForm.style.display = \"none\";\n  elements.loginForm.style.display = \"flex\";\n}\n\nfunction register() {\n  let name = elements.registrationName.value;\n  let email = elements.registrationEmail.value;\n  let password = elements.registrationPassword.value;\n\n  if (!validate_field(name) || !validate_email(email) || !validate_password(password)) {\n    alert('Registration failed. Please check your inputs.');\n    return;\n  }\n\n  auth.createUserWithEmailAndPassword(email, password)\n    .then((userCredential) => {\n      let user = userCredential.user;\n      let database_ref = database.ref();\n      let user_data = {\n        name: name,\n        email: email,\n        last_login: Date.now()\n      };\n      database_ref.child('users/' + user.uid).set(user_data);\n      saveUserDataToLocalStorage(user_data);\n      alert('Registration successful!');\n      clearRegistrationForm();\n      window.location.href = \"./index.html\";\n    })\n    .catch((error) => {\n      alert(`Registration failed: ${error.message}`);\n    });\n}\n\nfunction login() {\n  let email = elements.loginEmail.value;\n  let password = elements.loginPassword.value;\n\n  if (!validate_email(email) || !validate_password(password)) {\n    alert('Login failed. Please check your inputs.');\n    return;\n  }\n\n  auth.signInWithEmailAndPassword(email, password)\n    .then((userCredential) => {\n      let user = userCredential.user;\n      let database_ref = database.ref();\n      let user_data = {\n        last_login: Date.now()\n      };\n      database_ref.child('users/' + user.uid).update(user_data);\n      saveUserDataToLocalStorage(user_data);\n      alert('Login successful!');\n      displayUserInfo(user);\n      clearLoginForm();\n      window.location.href = \"./index.html\";\n    })\n    .catch((error) => {\n      alert(`Login failed: ${error.message}`);\n    });\n}\n\nfunction validate_email(email) {\n  let expression = /^[^@]+@\\w+(\\.\\w+)+\\w$/;\n  return expression.test(email);\n}\n\nfunction validate_password(password) {\n  return password.length >= 6;\n}\n\nfunction validate_field(field) {\n  return field.trim() !== '';\n}\n\nfunction clearRegistrationForm() {\n  elements.registrationName.value = '';\n  elements.registrationEmail.value = '';\n  elements.registrationPassword.value = '';\n}\n\nfunction clearLoginForm() {\n  elements.loginEmail.value = '';\n  elements.loginPassword.value = '';\n}\n\nfunction displayUserInfo(user) {\n  if (elements.userInfoContainer && elements.userNameElement) {\n    elements.userInfoContainer.textContent = `Welcome, ${user.displayName || user.email}!`;\n    elements.userNameElement.textContent = user.displayName || user.email;\n  } else {\n    console.error(\"Element with id 'user_info' or class 'user-name' not found.\");\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  elements.closeModalButton.addEventListener('click', closeModal);\n  elements.showRegistrationFormButton.addEventListener('click', showRegistrationForm);\n  elements.showLoginFormButton.addEventListener('click', showLoginForm);\n  elements.registerButton.addEventListener('click', register);\n  elements.loginButton.addEventListener('click', login);\n\n  elements.registrationForm.addEventListener('keydown', (event) => {\n    if (event.key === 'Enter') {\n      register();\n    }\n  });\n\n  elements.loginForm.addEventListener('keydown', (event) => {\n    if (event.key === 'Enter') {\n      login();\n    }\n  });\n\n  function loginWithGoogle() {\n    const provider = new firebase.auth.GoogleAuthProvider();\n\n    auth.signInWithPopup(provider)\n      .then((result) => {\n        const user = result.user;\n      })\n      .catch((error) => {\n        console.error('Google login error:', error);\n      });\n  }\n  elements.googleSignInButton.addEventListener('click', loginWithGoogle);\n\n  function logout() {\n    localStorage.removeItem('user_data');\n    auth.signOut()\n      .then(() => {\n        window.location.href = \"/\";\n      })\n      .catch((error) => {\n        console.error('Logout failed:', error);\n      });\n  }\n  elements.logoutButton.addEventListener('click', logout);\n});\nfirebase.auth().onAuthStateChanged(updateUI);\n"],"names":["elements","firebaseConfig","auth","database","saveUserDataToLocalStorage","userData","closeModal","showRegistrationForm","showLoginForm","register","name","email","password","validate_field","validate_email","validate_password","userCredential","user","database_ref","user_data","clearRegistrationForm","error","login","displayUserInfo","clearLoginForm","field","event","loginWithGoogle","provider","result","logout"],"mappings":"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"}